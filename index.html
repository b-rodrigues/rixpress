<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Build Reproducible Analytical Pipelines With Nix • rixpress</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Build Reproducible Analytical Pipelines With Nix">
<meta name="description" content="Simplifies the creation of reproducible analytical pipelines using the Nix package manager as a build automation tool. Heavily inspired by the targets package.">
<meta property="og:description" content="Simplifies the creation of reproducible analytical pipelines using the Nix package manager as a build automation tool. Heavily inspired by the targets package.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">rixpress</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/b-rodrigues/rixpress/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="rixpress-reproducible-analytical-pipelines-with-nix">rixpress: Reproducible Analytical Pipelines with Nix<a class="anchor" aria-label="anchor" href="#rixpress-reproducible-analytical-pipelines-with-nix"></a>
</h1></div>
<p>This package provides a framework for building reproducible analytical pipelines using Nix, heavily inspired by the R package <code>targets</code>. It leverages the <code>rix</code> package to generate a <code>default.nix</code> file, ensuring the pipeline runs in a fully reproducible Nix-managed environment. The pipeline itself is defined in a <code>pipeline.nix</code> file, which is automatically generated based on simple R declarations. Concretely, <a href="https://docs.ropensci.org/rix/" class="external-link">rix</a> made using Nix as a package manager easier for R users, <a href="https://github.com/b-rodrigues/rixpress/" class="external-link">rixpress</a> makes it now easy to use Nix as a build automation tool for R users!</p>
<p>For example this R script:</p>
<p>```{r, eval = FALSE} library(rixpress)</p>
<p>d1 &lt;- rxp_r(mtcars_am, filter(mtcars, am == 1)) d2 &lt;- rxp_r(mtcars_head, head(mtcars_am)) d3 &lt;- rxp_r(mtcars_tail, tail(mtcars_head)) d4 &lt;- rxp_r(mtcars_mpg, select(mtcars_tail, mpg)) doc &lt;- rxp_quarto(page, “page.qmd”)</p>
<p>rxp_list &lt;- list(d1, d2, d3, d4, doc)</p>
<p>rixpress(rxp_list)</p>
<p>rxp_make()</p>
<pre><code>
This workflow generates a `pipeline.nix` file, assuming a `default.nix` is already
available to define the environment. Each output (e.g., `mtcars_am`, `mtcars_head`,
`mtcars_tail`, `mtcars_mpg`, `page`) is built by Nix within this environment.

When you run `rixpress(rxp_list)`, it creates `pipeline.nix` and a `_rixpress/`
folder containing a JSON representation of the pipeline’s DAG (Directed Acyclic
Graph). You can visualize the pipeline using `plot_dag()`.

You can read outputs with `rxp_read("mtcars_mpg")` or load them into the global
environment with `rxp_load("mtcars_mpg")`. For complex outputs such as documents,
(for example the Quarto document defined above, called `page`, `rxp_read("page")`
returns its file path, which you can open with `browseURL("path/to/page")`.

## Purpose

The goal is to create data analysis pipelines that are:

- **Fully Reproducible:** Work the same way across machines and over time.
- **Multi-Language:** Allow steps in R, Python (planned), or other languages supported by Nix.
- **Inspired by targets:** Mimic its dependency tracking and task orchestration, enhanced by Nix’s deterministic builds.

By combining Nix’s reproducibility with a targets-like structure, you can
rebuild every step of your analysis—data processing, modeling, reporting—exactly
as intended, even years later or on different systems (as long as the sources
stay available or the systems are supported by Nix of course).

## How It Works

### Environment Setup with `default.nix`

- The `rix` package creates a `default.nix` file specifying your software
  environment (e.g., R version, packages).
- `{rixpress}` generates a `pipeline.nix` which builds a (potentially) polyglott
  data science project using Nix as the build automation tool.
- The `default.nix` generated by `{rix}` is used to provide the right environment
  to the pipeline.

### Pipeline Definition
- Define steps (derivations) in a `pipeline.nix` file, which can use R or
  other languages.
- Each derivation produces outputs like datasets or reports.

### Dependency Graph
- A `dag.json` file maps out the relationships between derivations.
- R scripts process this JSON to add correct dependency loading to `pipeline.nix`.

### Building the Pipeline
- Run `rxp_make()` to execute the pipeline, storing outputs in the Nix store
  (e.g., `/nix/store/...`).
- Easily recover the outputs in your current R session using `rxp_read()` and
  `rxp_lead()`.

## Key Advantages of Using Nix

- **Complete Reproducibility:** Pins all dependencies to exact versions.
- **Multi-Language Support:** Unlike `targets`, it’s not limited to R.
- **Isolation:** Each step runs in a sandbox, avoiding system interference.
- **Portability:** Share your Nix files, and anyone with Nix can rebuild your work.

## Inspiration from `targets`

This package borrows from `targets`:

- **Dependency Tracking:** Ensures steps only rerun when inputs change.
- **Modularity:** Breaks workflows into reusable steps.
- **Automation:** Executes tasks in the right order.

Nix extends these ideas beyond R into a cross-language, reproducible framework.

## Installation

### Prerequisites

#### Install Nix
tbd

#### Install R
tbd

### Install from GitHub

To install this package directly from GitHub, use the `remotes` R package:

```r
# Install remotes if you don’t have it
if (!require("remotes")) install.packages("remotes")

# Install the package from GitHub
remotes::install_github("b-rodrigues/rixpress")</code></pre>
<div class="section level2">
<h2 id="usage-example">Usage Example<a class="anchor" aria-label="anchor" href="#usage-example"></a>
</h2>
<div class="section level3">
<h3 id="define-your-pipeline-in-r">Define Your Pipeline in R<a class="anchor" aria-label="anchor" href="#define-your-pipeline-in-r"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create derivations</span></span>
<span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rxp_r.html">rxp_r</a></span><span class="op">(</span><span class="va">mtcars_am</span>, <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">am</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rxp_r.html">rxp_r</a></span><span class="op">(</span><span class="va">mtcars_head</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mtcars_am</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Collect into a list</span></span>
<span><span class="va">rxp_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save or process further (e.g., generate pipeline.nix and dag.json)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="build-the-pipeline">Build the Pipeline<a class="anchor" aria-label="anchor" href="#build-the-pipeline"></a>
</h3>
<p>Generate <code>pipeline.nix</code> and <code>dag.json</code> using provided scripts (e.g., <code>generate_dag.R</code>, <code>postprocess_nix.R</code>). Then run:</p>
<p><code>{r, eval = FALSE} rxp_make()</code></p>
<p>This builds all derivations, producing outputs in the Nix store.</p>
</div>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>TBD</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/b-rodrigues/rixpress/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/b-rodrigues/rixpress/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rixpress</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Bruno Rodrigues <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bruno Rodrigues.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
