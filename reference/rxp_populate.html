<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate Nix Pipeline Code — rxp_populate • rixpress</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Nix Pipeline Code — rxp_populate"><meta name="description" content="This function generates a pipeline.nix file based on a list of derivation
objects. Each derivation defines a build step, and rxp_populate() chains these
steps and handles the serialization and conversion of Python objects into R
objects (or vice-versa). Derivations are created with rxp_r(), rxp_py()
and so on. By default, the pipeline is also immediately built after being
generated, but the build process can be postponed by setting build to
FALSE. In this case, the pipeline can then be built using rxp_make() at
a later stage."><meta property="og:description" content="This function generates a pipeline.nix file based on a list of derivation
objects. Each derivation defines a build step, and rxp_populate() chains these
steps and handles the serialization and conversion of Python objects into R
objects (or vice-versa). Derivations are created with rxp_r(), rxp_py()
and so on. By default, the pipeline is also immediately built after being
generated, but the build process can be postponed by setting build to
FALSE. In this case, the pipeline can then be built using rxp_make() at
a later stage."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rixpress</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/intro-concepts.html">Introductory concepts</a></li>
    <li><a class="dropdown-item" href="../articles/scope.html">Scope and Roadmap</a></li>
    <li><a class="dropdown-item" href="../articles/core-functions.html">Core rixpress Functions and Usage</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial.html">Setting up a pipeline from scratch: a tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/importing-data.html">Importing Data Files</a></li>
    <li><a class="dropdown-item" href="../articles/debugging.html">Effective debugging</a></li>
    <li><a class="dropdown-item" href="../articles/gc.html">Managing Cached Build Artifacts</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Polyglot pipelines</h6></li>
    <li><a class="dropdown-item" href="../articles/polyglot.html">Polyglot pipelines and literate programming with Quarto or R Markdown</a></li>
    <li><a class="dropdown-item" href="../articles/polyglot-julia.html">Polyglot pipelines with Julia and R</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced topics</h6></li>
    <li><a class="dropdown-item" href="../articles/ci.html">Running pipelines in CI</a></li>
    <li><a class="dropdown-item" href="../articles/cmdstanr.html">Using {cmdstanr} with {rixpress}</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/b-rodrigues/rixpress/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generate Nix Pipeline Code</h1>
      <small class="dont-index">Source: <a href="https://github.com/b-rodrigues/rixpress/blob/main/R/rxp_populate.R" class="external-link"><code>R/rxp_populate.R</code></a></small>
      <div class="d-none name"><code>rxp_populate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates a <code>pipeline.nix</code> file based on a list of derivation
objects. Each derivation defines a build step, and <code>rxp_populate()</code> chains these
steps and handles the serialization and conversion of Python objects into R
objects (or vice-versa). Derivations are created with <code><a href="rxp_r.html">rxp_r()</a></code>, <code><a href="rxp_py.html">rxp_py()</a></code>
and so on. By default, the pipeline is also immediately built after being
generated, but the build process can be postponed by setting <code>build</code> to
FALSE. In this case, the pipeline can then be built using <code><a href="rxp_make.html">rxp_make()</a></code> at
a later stage.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rxp_populate</span><span class="op">(</span><span class="va">derivs</span>, project_path <span class="op">=</span> <span class="st">"."</span>, build <span class="op">=</span> <span class="cn">FALSE</span>, py_imports <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-derivs">derivs<a class="anchor" aria-label="anchor" href="#arg-derivs"></a></dt>
<dd><p>A list of derivation objects, where each object is a list of
five elements:
- <code>$name</code>, character, name of the derivation
- <code>$snippet</code>, character, the nix code snippet to build this derivation
- <code>$type</code>, character, can be R, Python or Quarto
- <code>$additional_files</code>, character vector of paths to files to make
available to build sandbox
- <code>$nix_env</code>, character, path to Nix environment to build this derivation
A single deriv is the output of <code><a href="rxp_r.html">rxp_r()</a></code>, <code><a href="rxp_qmd.html">rxp_qmd()</a></code> or <code><a href="rxp_py.html">rxp_py()</a></code>
function.</p></dd>


<dt id="arg-project-path">project_path<a class="anchor" aria-label="anchor" href="#arg-project-path"></a></dt>
<dd><p>Path to root of project, defaults to ".".</p></dd>


<dt id="arg-build">build<a class="anchor" aria-label="anchor" href="#arg-build"></a></dt>
<dd><p>Logical, defaults to FALSE. Should the pipeline get built right
after being generated? When FALSE, use <code><a href="rxp_make.html">rxp_make()</a></code> to build the pipeline
at a later stage.</p></dd>


<dt id="arg-py-imports">py_imports<a class="anchor" aria-label="anchor" href="#arg-py-imports"></a></dt>
<dd><p>Named character vector of Python import rewrites. Names are
the base modules that rixpress auto-imports as "import <name>", and values
are the desired import lines. For example: c(numpy = "import numpy as np",
xgboost = "from xgboost import XGBClassifier"). Each entry is applied by
replacing "import <name>" with the provided string across generated
_rixpress Python library files.</name></name></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed down to methods. Use <code>max-jobs</code> and
<code>cores</code> to set parallelism during build. See the documentation of
<code><a href="rxp_make.html">rxp_make()</a></code> for more details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Nothing, writes a file called <code>pipeline.nix</code> with the Nix code to
build the pipeline.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The generated <code>pipeline.nix</code> expression includes:</p><ul><li><p>the required imports of environments, typically <code>default.nix</code> files generated by
the <code>rix</code> package;</p></li>
<li><p>correct handling of interdependencies of the different derivations;</p></li>
<li><p>serialization and deserialization of both R and Python objects, and conversion
between them when objects are passed from one language to another;</p></li>
<li><p>correct loading of R and Python packages, or extra functions needed to build
specific targets</p></li>
</ul><p>Inline Python import adjustments
In some cases, due to the automatic handling of Python packages, users might
want to change import statements. By default if, say, <code>pandas</code> is needed to
build a derivation, it will be imported with <code>import pandas</code>. However, Python
programmers typically use <code>import pandas as pd</code>. You can either:</p><ul><li><p>use <code>py_imports</code> to rewrite these automatically during population, or</p></li>
<li><p>use <code><a href="adjust_import.html">adjust_import()</a></code> for advanced/manual control.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other pipeline functions:
<code><a href="rxp_make.html">rxp_make</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create derivation objects</span></span></span>
<span class="r-in"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="rxp_r.html">rxp_r</a></span><span class="op">(</span><span class="va">mtcars_am</span>, <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">am</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="rxp_r.html">rxp_r</a></span><span class="op">(</span><span class="va">mtcars_head</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mtcars_am</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">list_derivs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate and build in one go</span></span></span>
<span class="r-in"><span><span class="fu">rxp_populate</span><span class="op">(</span>derivs <span class="op">=</span> <span class="va">list_derivs</span>, project_path <span class="op">=</span> <span class="st">"."</span>, build <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or only populate, with inline Python import adjustments</span></span></span>
<span class="r-in"><span><span class="fu">rxp_populate</span><span class="op">(</span></span></span>
<span class="r-in"><span>  derivs <span class="op">=</span> <span class="va">list_derivs</span>,</span></span>
<span class="r-in"><span>  project_path <span class="op">=</span> <span class="st">"."</span>,</span></span>
<span class="r-in"><span>  build <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  py_imports <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>pandas <span class="op">=</span> <span class="st">"import pandas as pd"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Then later:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="rxp_make.html">rxp_make</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bruno Rodrigues.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

